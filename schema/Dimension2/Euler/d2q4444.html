<p>The D2Q4444 scheme is the smallest vectorial scheme that can be used for inviscid flows in dimension two.</p>
<hr />
<p><strong>Vectorial scheme</strong></p>
<p>The D2Q4444 is a vectorial scheme with one particle distribution function for each conserved moment (the mass, the momentum in x and y directions, and the total energy). Each particle distribution function is discretized with four velocities: <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20%28%5Clambda%2C%200%29" alt="(\lambda, 0)" title="(\lambda, 0)" class="math inline" />, <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20%280%2C%20%5Clambda%29" alt="(0, \lambda)" title="(0, \lambda)" class="math inline" />, <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20%28-%5Clambda%2C%200%29" alt="(-\lambda, 0)" title="(-\lambda, 0)" class="math inline" />, and <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20%280%2C-%5Clambda%29" alt="(0,-\lambda)" title="(0,-\lambda)" class="math inline" /> where <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5Clambda" alt="\lambda" title="\lambda" class="math inline" /> is the lattice velocity.</p>
<p>The main interest of this scheme is its simplicity. This scheme is very rough and robust. However, the structure of the numerical diffusion cannot be modified to fit the physical diffusion operator of Navier-Stokes. He behaves essentially like the D1Q2 in dimension one.</p>
<hr />
<p><strong>Parameters</strong></p>
<p>To ensure isotropy, seven parameters are left free:</p>
<ul>
<li>the <strong>lattice velocity</strong> denoted by <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5Clambda" alt="\lambda" title="\lambda" class="math inline" />;</li>
<li>the <strong>three relaxation parameters of first-order</strong> <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20s_%7B%5Crho%7D" alt="s_{\rho}" title="s_{\rho}" class="math inline" /> , <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20s_u" alt="s_u" title="s_u" class="math inline" /> , and <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20s_p" alt="s_p" title="s_p" class="math inline" /> ;</li>
<li>the <strong>three relaxation parameters of second-order</strong> <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20s_%7B%5Crho2%7D" alt="s_{\rho2}" title="s_{\rho2}" class="math inline" /> , <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20s_%7Bu2%7D" alt="s_{u2}" title="s_{u2}" class="math inline" /> , and <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20s_%7Bp2%7D" alt="s_{p2}" title="s_{p2}" class="math inline" /> .</li>
</ul>
<ol type="1">
<li><em>The lattice velocity <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5Clambda" alt="\lambda" title="\lambda" class="math inline" /></em></li>
</ol>
<blockquote>
<p>The lattice velocity is defined as the ratio between the space step and the time step. This velocity must satisfy a CFL type condition to ensure the stability of the scheme.</p>
<p>This parameter is involved in the numerical diffusion: the higher the lattice velocity, the higher the numerical diffusion.</p>
<ul>
<li>The parameter <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5Clambda" alt="\lambda" title="\lambda" class="math inline" /> has to be greater than all the physical velocities of the problem;</li>
<li>The parameter <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5Clambda" alt="\lambda" title="\lambda" class="math inline" /> should be as small as possible while preserving the stability in order to minimise the numerical diffusion.</li>
</ul>
</blockquote>
<ol start="2" type="1">
<li><em>The relaxation parameters of first-order <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20s_%7B%5Crho%7D" alt="s_{\rho}" title="s_{\rho}" class="math inline" /> , <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20s_u" alt="s_u" title="s_u" class="math inline" /> , and <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20s_p" alt="s_p" title="s_p" class="math inline" /></em></li>
</ol>
<blockquote>
<p>These three relaxation parameters are involved in the relaxation towards equilibrium for the three first-order non-conserved moments of the scheme. These parameters should take real values between <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%200" alt="0" title="0" class="math inline" /> and <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%202" alt="2" title="2" class="math inline" />.</p>
<p>These parameters play also a role in the numerical diffusion: <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20s_%7B%5Crho%7D" alt="s_{\rho}" title="s_{\rho}" class="math inline" /> (<em>resp.</em> <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20s_u" alt="s_u" title="s_u" class="math inline" /> , <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20s_p" alt="s_p" title="s_p" class="math inline" />) appears in the numerical diffusion operator of the mass (<em>resp.</em> momentum, energy) conservation through the Henon parameter.</p>
<ul>
<li>Increasing the values of the parameters <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20s_%7B%5Crho%7D" alt="s_{\rho}" title="s_{\rho}" class="math inline" /> , <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20s_u" alt="s_u" title="s_u" class="math inline" /> , and <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20s_p" alt="s_p" title="s_p" class="math inline" /> decreases the numerical diffusion;</li>
<li>Decreasing the values improves the stability.</li>
</ul>
</blockquote>
<ol start="3" type="1">
<li><em>The relaxation parameters of second-order <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20s_%7B%5Crho%202%7D" alt="s_{\rho 2}" title="s_{\rho 2}" class="math inline" /> , <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20s_%7Bu2%7D" alt="s_{u2}" title="s_{u2}" class="math inline" /> , and <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20s_%7Bp2%7D" alt="s_{p2}" title="s_{p2}" class="math inline" /></em></li>
</ol>
<blockquote>
<p>These three relaxation parameters are involved in the relaxation towards equilibrium for the three second-order non-conserved moments of the scheme. These parameters should take real values between <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%200" alt="0" title="0" class="math inline" /> and <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%202" alt="2" title="2" class="math inline" />.</p>
<p>These parameters do not play a role in the second-order numerical diffusion but in the stability.</p>
</blockquote>
<hr />
<p><strong>How to choose the parameters ?</strong></p>
<p>Even if the equivalent equations give only an asymptotic representation of the scheme, the structure of the second-order operator (corresponding to a numerical diffusion) is very helpfull for selecting the several parameters. The complete structure can be computed using the tab <code>Equivalent equations</code>.</p>
<p>For each relaxation parameter <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20s%20%5Cin%20%5Clbrace%20s_%7B%5Crho%7D%2C%20s_u%2C%20s_p%20%5Crbrace" alt="s \in \lbrace s_{\rho}, s_u, s_p \rbrace" title="s \in \lbrace s_{\rho}, s_u, s_p \rbrace" class="math inline" /> , the Henon parameter is defined by <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5Csigma%20%3D%201%2Fs%20-%201%2F2" alt="\sigma = 1/s - 1/2" title="\sigma = 1/s - 1/2" class="math inline" /> and the amplitude of the associated numerical diffusion is given by <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5CDelta%20x%20%5Clambda%5Csigma" alt="\Delta x \lambda\sigma" title="\Delta x \lambda\sigma" class="math inline" /> , where <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5CDelta%20x" alt="\Delta x" title="\Delta x" class="math inline" /> is the space step.</p>
<blockquote>
<p>→ the lattice velocity <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20%5Clambda" alt="\lambda" title="\lambda" class="math inline" /> has to be large enough to ensure that the second-order operator is positive (in the sense of the parabolic system);</p>
<p>→ the relaxation parameters of first-order should be chosen as close to <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%202" alt="2" title="2" class="math inline" /> as possible to minimise the effect of the numerical diffusion;</p>
<p>→ a good choice for the relaxation paramters of second-order is often to take these three parameters equal to the first-order associated relaxation parameters: <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20s_%7B%5Crho2%7D%20%3D%20s_%7B%5Crho%7D" alt="s_{\rho2} = s_{\rho}" title="s_{\rho2} = s_{\rho}" class="math inline" /> , <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20s_%7Bu2%7D%3Ds_u" alt="s_{u2}=s_u" title="s_{u2}=s_u" class="math inline" /> , and <img style="vertical-align:middle" src="https://latex.codecogs.com/png.latex?%5Ctextstyle%20s_%7Bp2%7D%3Ds_p" alt="s_{p2}=s_p" title="s_{p2}=s_p" class="math inline" />.</p>
</blockquote>
<hr />
<p><em>See the tabs <code>Linear Stability</code> and <code>Parametric Study</code> for more informations</em>.</p>
